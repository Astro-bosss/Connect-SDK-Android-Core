plugins {
    id 'com.android.library'
    id 'maven-publish'
}

android {
    namespace 'com.connectsdk'
    compileSdk 34

    defaultConfig {
        minSdk 24
        targetSdk 34
        // Eğer Apache HTTP legacy gerekiyorsa, aşağıdaki satırı uncomment edin:
        // useLibrary 'org.apache.http.legacy'
    }

    // AGP 8+ için buildToolsVersion belirtmeye gerek yok (otomatik seçer)

    sourceSets {
        main {
            manifest.srcFile 'src/main/AndroidManifest.xml'
            java.srcDirs = ['src/main/java']
            res.srcDirs = ['src/main/res']
            assets.srcDirs = ['src/main/assets']
            // libs klasörü otomatik tanınır; ayrıca fileTree de ekliyoruz.
        }
    }

    buildTypes {
        release {
            minifyEnabled false
            // consumerProguardFiles 'consumer-rules.pro' // gerekiyorsa ekleyin
        }
        debug {
            minifyEnabled false
        }
    }

    compileOptions {
        sourceCompatibility JavaVersion.VERSION_1_8
        targetCompatibility JavaVersion.VERSION_1_8
    }
}

dependencies {
    // libs klasöründeki tüm jar'ları dahil et
    implementation fileTree(dir: 'libs', include: ['*.jar'])

    // JmDNS (zeroconf) — ÖNEMLİ
    implementation 'org.jmdns:jmdns:3.6.2'

    // Apache HTTP client (gerekiyorsa)
    implementation 'org.apache.httpcomponents:httpclient-android:4.3.5.1'

    // AndroidX
    implementation 'androidx.localbroadcastmanager:localbroadcastmanager:1.1.0'
    implementation 'androidx.preference:preference:1.2.1'

    // Diğer bağımlılıklar
    implementation 'org.java-websocket:Java-WebSocket:1.5.7'
    implementation 'com.google.android.gms:play-services-cast-framework:21.4.0'
    implementation 'com.googlecode.plist:dd-plist:1.28'
    implementation 'com.nimbusds:srp6a:2.1.0'
    implementation 'net.i2p.crypto:eddsa:0.3.0'
}

afterEvaluate {
    publishing {
        publications {
            create("release", MavenPublication) {
                groupId = "com.connectsdk"
                artifactId = "core"
                version = "1.0.0"

                // Android Library için doğru publication
                from components.findByName("default")
            }
        }
        repositories {
            maven {
                url = uri("${rootProject.projectDir}/repo")
            }
        }
    }
}